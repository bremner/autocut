# Autocut

I needed a way to make videos for my [Calculus
MOOC](http://mooculus.osu.edu/) very quickly, and so I build the
`autocut`ter.

This tool takes a list of video files, listens to the audio to
determine where I start and stop speaking, and builds an edit list
suitable for [MLT](https://github.com/mltframework/mlt).

If you want help using it, please feel free to contact me.

## Requirements

There are some standalone packages to install:

* [ffmpeg](http://ffmpeg.org/) extracts the audio from the movies;
* [sox](http://sox.sourceforge.net/) does some audio processing;
* [MLT](https://github.com/mltframework/mlt) produces the final version; and
* [MP4Box](http://gpac.wp.mines-telecom.fr/mp4box/) prepares the video for streaming.

This is a ruby script, and it expects that you have installed some gems:

* [libxml-ruby](http://xml4r.github.io/libxml-ruby/) for parsing the `XML` generated by MLT,
* [wavefile](https://github.com/jstrait/wavefile) for handling `wav` files, and
* [fftw3](https://github.com/evan/fftw3) for doing the Fourier transform.

## Instructions

Here is a sample input file.  Let's call it `sample.xml`

    <?xml version="1.0" encoding="UTF-8"?>
    <movie author="Jim Fowler">
      <video src="title.mp4" audio="intro.wav" in="0" out="3"/>
      <video src="welcome-to-the-course.mts"/>
      <video src="doing-work-on-paper.mts" flip="true"/>
      <video src="farewell-everybody.mts"/>
      <video src="end-title.mp4" audio="outro.wav" in="0" out="5"/>
    </movie>

If you run `ruby autocut.rb sample.xml` you will get `editlist.xml`
which you can then run through `melt` to produce a complete video.

The `in` and `out` timestamps are in seconds, relative to the given
video file.  If you don't include one of them, then the missing
cutpoints are determined by listening for a human voice.  When it
finds them, it prints out a new `video src` line, so you can replace
your original and fiddle with the cutpoints by hand.

If you include a `flip` attribute, the video gets flipped.

If you include an `audio` tag, then the given audio file will play at
the same time as the given video; the script creates the appropriate
tractors and transitions to mix the audio in MLT.
